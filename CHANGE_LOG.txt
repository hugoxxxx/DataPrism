DataPrism change log
====================

2026-01-20
- Init log file for PM review.
- UI import: drag-and-drop enabled for image extensions; added Browse files… button that opens a file dialog and reuses drop handler.
- UI list: hooked center view to PhotoDataModel with QTableView; dropped/browsed files are added into the model, placeholder hides when list has data.
- EXIF: MainWindow now wires ExifToolWorker via QThread; new imports trigger queued EXIF reads, results populate PhotoDataModel; worker errors logged; thread stops on window destruction.
- Inspector: right panel now shows selected photo info (file, camera, lens, date, status) with live updates when selection or EXIF results change.
- EXIF decoding: ExifTool worker now decodes stdout/stderr as UTF-8 with errors=replace and guards JSON parse errors to avoid GBK UnicodeDecodeError; timeout bumped to 15s.
- Fonts: removed explicit "System" font to let Qt use default Windows font and silence DirectWrite warnings.
- Inspector thumbnail: added 180x180 preview in inspector; loads QPixmap from file, caches per photo, clears when no selection.
- UI aesthetics (v0.2.0): upgraded table to 52px rows, no grid, macOS colors; status column now shows colored dots (green/blue/red/gray); sidebar buttons have 10px radius with gradients; inspector uses Consolas monospace for data, hierarchical labels, 200px thumbnail with separator; global Big Sur theme (#f5f5f7 background).
- Selection contrast: deepened selection background to #0051d5 with explicit white text for better visibility.
- Metadata expansion (v0.2.1): extended PhotoItem with aperture/shutter/ISO/focal_length/film_stock/serial_number fields; table now 8 columns (File/Camera/Lens/Aperture/Shutter/ISO/Date/Status); formatted display (f/2.8, 1/125s, -- for missing); auto-parse exposure from EXIF; inspector adds Exposure section with bold Consolas font; optimized column widths (fixed for exposure, stretch for file).
- i18n support (v0.2.1): created src/utils/i18n.py translation manager with auto system language detection (Chinese/English); added 中/EN toggle button in sidebar; all UI text (titles/labels/buttons/tooltips/columns) now use tr() function; refresh_ui() method updates entire interface on language switch.
- JSON film log import (v0.3.0): created src/core/json_parser.py with FilmLogParser supporting Lightme/Logbook JSON formats; FilmLogEntry dataclass extracts camera/lens/aperture/shutter/ISO/film_stock/timestamp fields with flexible field name mapping; handles array wrappers (frames/entries/shots) and multiple timestamp formats.
- Photo matching algorithms (v0.3.0): implemented src/core/json_matcher.py with PhotoMatcher class; three strategies: match_by_timestamp (±5min tolerance), match_by_sequence (1:1 order), match_hybrid (timestamp first, fallback to sequence if <50% matched); get_match_statistics returns match rate and counts.
- JSON import UI (v0.3.0): added green gradient "Import JSON" button in sidebar; import_json() method opens file dialog, parses JSON, auto-matches photos, shows preview dialog; integrated with FilmLogParser and PhotoMatcher; checks for imported photos before proceeding.
- Match preview dialog (v0.3.0): created src/ui/match_dialog.py with MatchPreviewDialog showing 6-column table (Photo File/Date → Log Camera/Lens/Date); displays match statistics (matched/total with percentage); time offset adjustment spinbox (±180 minutes) with rematch button; macOS Big Sur styling with rounded corners; confirm/cancel buttons.
- Batch EXIF write (v0.3.0): extended ExifToolWorker.batch_write_exif() for multi-file async writes with progress signals; _apply_json_matches() builds EXIF tasks mapping log entries to Make/Model/LensModel/FNumber/ExposureTime/ISO/FocalLength/DateTimeOriginal/UserComment; QProgressDialog shows write progress; auto-refreshes photo data after completion; error handling with success/failure counts.
- Bug fix (v0.3.0): corrected PhotoMatcher instantiation in main_window.py and match_dialog.py; __init__ only takes time_tolerance_minutes parameter, photos/log_entries passed to match methods; added tuple-to-dict conversion for match results (List[Tuple[PhotoItem, FilmLogEntry]] to Dict[int, int] index mapping) to interface with MatchPreviewDialog.
- Bug fix (v0.3.0): fixed AttributeError in match_dialog.py where PhotoItem.date_taken was accessed but doesn't exist; changed to extract date from exif_data['DateTimeOriginal'] or exif_data['CreateDate']; updated rematch_with_offset to adjust EXIF date strings directly instead of using non-existent date_taken attribute.
